# –°–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ –≤ C

## üìö –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏](#1-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
2. [–¢–∏–ø—ã —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏](#2-—Ç–∏–ø—ã-—É–∫–∞–∑–∞—Ç–µ–ª–µ–π-–Ω–∞-—Ñ—É–Ω–∫—Ü–∏–∏)
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏](#3-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–ª—è-—Ö—Ä–∞–Ω–µ–Ω–∏—è-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
4. [–§—É–Ω–∫—Ü–∏—è dlopen - –∑–∞–≥—Ä—É–∑–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏](#4-—Ñ—É–Ω–∫—Ü–∏—è-dlopen---–∑–∞–≥—Ä—É–∑–∫–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
5. [–§—É–Ω–∫—Ü–∏—è dlsym - –ø–æ–∏—Å–∫ —Å–∏–º–≤–æ–ª–∞](#5-—Ñ—É–Ω–∫—Ü–∏—è-dlsym---–ø–æ–∏—Å–∫-—Å–∏–º–≤–æ–ª–∞)
6. [–§—É–Ω–∫—Ü–∏—è dlerror - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫](#6-—Ñ—É–Ω–∫—Ü–∏—è-dlerror---–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫)
7. [–§—É–Ω–∫—Ü–∏—è dlclose - –≤—ã–≥—Ä—É–∑–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏](#7-—Ñ—É–Ω–∫—Ü–∏—è-dlclose---–≤—ã–≥—Ä—É–∑–∫–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
8. [–í—ã–∑–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏](#8-–≤—ã–∑–æ–≤-–∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π-—Ñ—É–Ω–∫—Ü–∏–∏)
9. [–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä](#9-–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä)
10. [–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–±—ã—á–Ω—ã–º –≤—ã–∑–æ–≤–æ–º](#10-—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ-—Å-–æ–±—ã—á–Ω—ã–º-–≤—ã–∑–æ–≤–æ–º)

---

## 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

```c
#include <dlfcn.h>
```

**–ß—Ç–æ —ç—Ç–æ:** –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª POSIX API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ (.so —Ñ–∞–π–ª–∞–º–∏ –≤ Linux).

**–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏:**

- `dlopen()` - –∑–∞–≥—Ä—É–∑–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- `dlsym()` - –ø–æ–∏—Å–∫ —Å–∏–º–≤–æ–ª–∞ (—Ñ—É–Ω–∫—Ü–∏–∏)
- `dlclose()` - –≤—ã–≥—Ä—É–∑–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- `dlerror()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –æ—à–∏–±–∫–∏

**–ö–æ–º–ø–∏–ª—è—Ü–∏—è:**
–ü—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ–ª–∞–≥ `-ldl`:

```bash
gcc program.c -o program -ldl
```

–í CMake:

```cmake
target_link_libraries(program ${CMAKE_DL_LIBS})
```

---

## 2. –¢–∏–ø—ã —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å

```c
typedef int (*PrimeCountFunc)(int, int);
typedef int (*GCFFunc)(int, int);
```

### –†–∞–∑–±–æ—Ä –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

```c
typedef  int  (*PrimeCountFunc)  (int, int);
   ‚îÇ      ‚îÇ         ‚îÇ                 ‚îÇ
   ‚îÇ      ‚îÇ         ‚îÇ                 ‚îî‚îÄ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–∏
   ‚îÇ      ‚îÇ         ‚îî‚îÄ –ò–º—è –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞ (—É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é)
   ‚îÇ      ‚îî‚îÄ –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π —Ç–∏–ø —Ñ—É–Ω–∫—Ü–∏–∏
   ‚îî‚îÄ –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∏–ø–∞
```

### –ó–∞—á–µ–º –Ω—É–∂–Ω–æ

–ë–µ–∑ typedef:

```c
// –û–±—ä—è–≤–ª–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é (—á–∏—Ç–∞–µ—Ç—Å—è –ø–ª–æ—Ö–æ)
int (*my_function)(int, int);
```

–° typedef:

```c
// –°–æ–∑–¥–∞—ë–º —Ç–∏–ø "—É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é"
typedef int (*FuncType)(int, int);

// –¢–µ–ø–µ—Ä—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —á–∏—Ç–∞–µ—Ç—Å—è –ª–µ–≥–∫–æ
FuncType my_function;
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```c
// –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø
typedef int (*MathFunc)(int, int);

// –û–±—ä—è–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —ç—Ç–æ–≥–æ —Ç–∏–ø–∞
MathFunc func1;
MathFunc func2;

// –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–π
func1 = dlsym(handle, "Add");
func2 = dlsym(handle, "Multiply");

// –í—ã–∑—ã–≤–∞–µ–º
int result1 = func1(5, 3);  // –í—ã–∑–æ–≤ Add(5, 3)
int result2 = func2(5, 3);  // –í—ã–∑–æ–≤ Multiply(5, 3)
```

---

## 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

```c
typedef struct {
    void *handle;              // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
    PrimeCountFunc PrimeCount; // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é
    GCFFunc GCF;              // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é
    const char *name;         // –ò–º—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
} Library;
```

### –ü–æ–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

#### `void *handle`

- **–ß—Ç–æ —ç—Ç–æ:** "–†—É—á–∫–∞" (–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä) –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- **–û—Ç–∫—É–¥–∞ –±–µ—Ä—ë—Ç—Å—è:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π `dlopen()`
- **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω:** –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ù–µ–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ç–∏–ø:** –ú—ã –Ω–µ –∑–Ω–∞–µ–º, —á—Ç–æ –≤–Ω—É—Ç—Ä–∏, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞—ë–º –µ–≥–æ –≤ –¥—Ä—É–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### `PrimeCountFunc PrimeCount`

- **–ß—Ç–æ —ç—Ç–æ:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–∏–ø–∞ "—É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é"
- **–û—Ç–∫—É–¥–∞ –±–µ—Ä—ë—Ç—Å—è:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π `dlsym()`
- **–•—Ä–∞–Ω–∏—Ç:** –ê–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ `PrimeCount` –≤ –ø–∞–º—è—Ç–∏
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –í—ã–∑—ã–≤–∞–µ–º –∫–∞–∫ –æ–±—ã—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é: `PrimeCount(10, 20)`

#### `const char *name`

- **–ß—Ç–æ —ç—Ç–æ:** –ü—Ä–æ—Å—Ç–æ —Å—Ç—Ä–æ–∫–∞ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- **–ó–∞—á–µ–º:** –î–ª—è –≤—ã–≤–æ–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```c
// –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
Library current_lib = {NULL, NULL, NULL, NULL};
```

---

## 4. –§—É–Ω–∫—Ü–∏—è dlopen - –∑–∞–≥—Ä—É–∑–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

### –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```c
void *dlopen(const char *filename, int flags);
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

#### `filename` - –ø—É—Ç—å –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ

```c
dlopen("./libmath.so", flags);      // –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å
dlopen("/usr/lib/libmath.so", flags); // –ê–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å
dlopen("libmath.so", flags);         // –ü–æ–∏—Å–∫ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø—É—Ç—è—Ö
```

#### `flags` - —Ñ–ª–∞–≥–∏ –∑–∞–≥—Ä—É–∑–∫–∏

| –§–ª–∞–≥          | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                |
| ------------- | --------------------------------------------------------------------------------------- |
| `RTLD_LAZY`   | **–õ–µ–Ω–∏–≤–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ** - —Å–∏–º–≤–æ–ª—ã —Ä–µ–∑–æ–ª–≤—è—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ (–±—ã—Å—Ç—Ä–µ–µ –∑–∞–≥—Ä—É–∑–∫–∞) |
| `RTLD_NOW`    | **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ** - –≤—Å–µ —Å–∏–º–≤–æ–ª—ã —Ä–µ–∑–æ–ª–≤—è—Ç—Å—è —Å—Ä–∞–∑—É (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ)    |
| `RTLD_GLOBAL` | –°–∏–º–≤–æ–ª—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¥—Ä—É–≥–∏–º –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º                              |
| `RTLD_LOCAL`  | –°–∏–º–≤–æ–ª—ã –ª–æ–∫–∞–ª—å–Ω—ã –¥–ª—è —ç—Ç–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)                                     |

–§–ª–∞–≥–∏ –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å:

```c
dlopen("libmath.so", RTLD_LAZY | RTLD_GLOBAL);
```

### –í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

- **–ü—Ä–∏ —É—Å–ø–µ—Ö–µ:** –£–∫–∞–∑–∞—Ç–µ–ª—å (`void*`) –Ω–∞ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- **–ü—Ä–∏ –æ—à–∏–±–∫–µ:** `NULL`

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```c
void *handle = dlopen("./libmath1.so", RTLD_LAZY);

if (!handle) {
    fprintf(stderr, "–û—à–∏–±–∫–∞: %s\n", dlerror());
    return 1;
}
```

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏

1. –û–° –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
2. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–¥ –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
3. –í—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã (—Ñ—É–Ω–∫—Ü–∏–∏ —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º `__attribute__((constructor))`)
4. –†–µ–∑–æ–ª–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–¥—Ä—É–≥–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
5. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä

---

## 5. –§—É–Ω–∫—Ü–∏—è dlsym - –ø–æ–∏—Å–∫ —Å–∏–º–≤–æ–ª–∞

### –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```c
void *dlsym(void *handle, const char *symbol);
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

#### `handle` - –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

```c
void *handle = dlopen("libmath.so", RTLD_LAZY);
```

#### `symbol` - –∏–º—è —Å–∏–º–≤–æ–ª–∞ (—Å—Ç—Ä–æ–∫–∞!)

```c
dlsym(handle, "PrimeCount");  // –ò–º—è —Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞
dlsym(handle, "global_var");  // –ú–æ–∂–Ω–æ –∏—Å–∫–∞—Ç—å –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∏–º–µ–Ω–∏ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏!

### –í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

- **–ü—Ä–∏ —É—Å–ø–µ—Ö–µ:** –ê–¥—Ä–µ—Å —Å–∏–º–≤–æ–ª–∞ (`void*`)
- **–ü—Ä–∏ –æ—à–∏–±–∫–µ:** `NULL` (–Ω–æ —ç—Ç–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –æ—à–∏–±–∫–∞!)

### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–∫–∏

‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**

```c
void *func = dlsym(handle, "MyFunc");
if (func == NULL) {  // –ú–æ–∂–µ—Ç –¥–∞—Ç—å –ª–æ–∂–Ω–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ!
    // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
}
```

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**

```c
dlerror();  // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ—à–∏–±–∫–∏
void *func = dlsym(handle, "MyFunc");
char *error = dlerror();
if (error != NULL) {  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–µ—Ä–µ–∑ dlerror()
    fprintf(stderr, "–û—à–∏–±–∫–∞: %s\n", error);
}
```

### –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–∞

`dlsym` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `void*`, –Ω—É–∂–Ω–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ç–∏–ø—É —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é:

```c
typedef int (*MyFunc)(int, int);

MyFunc func = (MyFunc)dlsym(handle, "MyFunction");
```

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```c
// 1. –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é
typedef int (*PrimeCountFunc)(int, int);

// 2. –û—á–∏—â–∞–µ–º –±—É—Ñ–µ—Ä –æ—à–∏–±–æ–∫
dlerror();

// 3. –ò—â–µ–º —Ñ—É–Ω–∫—Ü–∏—é –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ
PrimeCountFunc PrimeCount = (PrimeCountFunc)dlsym(handle, "PrimeCount");

// 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—à–∏–±–∫—É
char *error = dlerror();
if (error != NULL) {
    fprintf(stderr, "–ù–µ –Ω–∞–π–¥–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è PrimeCount: %s\n", error);
    dlclose(handle);
    return 1;
}

// 5. –¢–µ–ø–µ—Ä—å –º–æ–∂–µ–º –≤—ã–∑—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é
int result = PrimeCount(10, 20);
```

---

## 6. –§—É–Ω–∫—Ü–∏—è dlerror - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```c
char *dlerror(void);
```

### –í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

- **–ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –æ—à–∏–±–∫–∏:** –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä–æ–∫—É —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–∫–∏
- **–ï—Å–ª–∏ –æ—à–∏–±–æ–∫ –Ω–µ—Ç:** `NULL`

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –í—ã–∑–æ–≤ `dlerror()` **—Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç** —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—à–∏–±–∫–∏!

```c
dlopen("nonexistent.so", RTLD_LAZY);  // –û—à–∏–±–∫–∞!

char *err1 = dlerror();  // –í–µ—Ä–Ω—ë—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏
char *err2 = dlerror();  // –í–µ—Ä–Ω—ë—Ç NULL (–æ—à–∏–±–∫–∞ —É–∂–µ —Å–±—Ä–æ—à–µ–Ω–∞)
```

### –ü–∞—Ç—Ç–µ—Ä–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –î–ª—è dlopen:

```c
void *handle = dlopen("libmath.so", RTLD_LAZY);
if (!handle) {
    fprintf(stderr, "–û—à–∏–±–∫–∞ dlopen: %s\n", dlerror());
    return 1;
}
```

#### –î–ª—è dlsym:

```c
dlerror();  // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ—à–∏–±–∫–∏

void *func = dlsym(handle, "MyFunc");

char *error = dlerror();
if (error != NULL) {
    fprintf(stderr, "–û—à–∏–±–∫–∞ dlsym: %s\n", error);
    return 1;
}
```

### –¢–∏–ø–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

```
./libmath.so: cannot open shared object file: No such file or directory
undefined symbol: MyFunction
./libmath.so: invalid ELF header
```

---

## 7. –§—É–Ω–∫—Ü–∏—è dlclose - –≤—ã–≥—Ä—É–∑–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

### –°–∏–≥–Ω–∞—Ç—É—Ä–∞

```c
int dlclose(void *handle);
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

- `handle` - –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–æ—Ç `dlopen`)

### –í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

- **0** –ø—Ä–∏ —É—Å–ø–µ—Ö–µ
- **–ù–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** –ø—Ä–∏ –æ—à–∏–±–∫–µ

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

1. –£–º–µ–Ω—å—à–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫ —Å—Å—ã–ª–æ–∫ –Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫—É
2. –ï—Å–ª–∏ —Å—á—ë—Ç—á–∏–∫ = 0:
   - –í—ã–∑—ã–≤–∞–µ—Ç –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã (`__attribute__((destructor))`)
   - –í—ã–≥—Ä—É–∂–∞–µ—Ç –∫–æ–¥ –∏–∑ –ø–∞–º—è—Ç–∏
   - –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã

### –°—á—ë—Ç—á–∏–∫ —Å—Å—ã–ª–æ–∫

```c
void *h1 = dlopen("lib.so", RTLD_LAZY);  // –°—á—ë—Ç—á–∏–∫ = 1
void *h2 = dlopen("lib.so", RTLD_LAZY);  // –°—á—ë—Ç—á–∏–∫ = 2 (—Ç–∞ –∂–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞!)

dlclose(h1);  // –°—á—ë—Ç—á–∏–∫ = 1 (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≤—Å—ë –µ—â—ë –≤ –ø–∞–º—è—Ç–∏)
dlclose(h2);  // –°—á—ë—Ç—á–∏–∫ = 0 (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≤—ã–≥—Ä—É–∂–µ–Ω–∞)
```

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```c
void *handle = dlopen("./libmath.so", RTLD_LAZY);

// ... —Ä–∞–±–æ—Ç–∞ —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π ...

if (handle != NULL) {
    if (dlclose(handle) != 0) {
        fprintf(stderr, "–û—à–∏–±–∫–∞ dlclose: %s\n", dlerror());
    }
}
```

### ‚ö†Ô∏è –í–∞–∂–Ω–æ

–ü–æ—Å–ª–µ `dlclose()` –≤—Å–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è **–Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏**!

```c
MyFunc func = dlsym(handle, "MyFunc");
dlclose(handle);
func(1, 2);  // ‚ùå Undefined behavior! –§—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–≥—Ä—É–∂–µ–Ω–∞
```

---

## 8. –í—ã–∑–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏

### –°–ø–æ—Å–æ–± 1: –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```c
typedef int (*MyFunc)(int, int);

MyFunc func = (MyFunc)dlsym(handle, "Add");

// –í—ã–∑—ã–≤–∞–µ–º –∫–∞–∫ –æ–±—ã—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
int result = func(5, 3);
```

### –°–ø–æ—Å–æ–± 2: –Ø–≤–Ω–∞—è —Ä–∞–∑—ã–º–µ–Ω–æ–≤–∫–∞

```c
typedef int (*MyFunc)(int, int);

MyFunc func = (MyFunc)dlsym(handle, "Add");

// –Ø–≤–Ω–æ —Ä–∞–∑—ã–º–µ–Ω–æ–≤—ã–≤–∞–µ–º —É–∫–∞–∑–∞—Ç–µ–ª—å
int result = (*func)(5, 3);
```

–û–±–∞ —Å–ø–æ—Å–æ–±–∞ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã! –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∫–æ–¥.

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –ø–∞–º—è—Ç–∏

```c
result = func(5, 3);
```

**–í –∞—Å—Å–µ–º–±–ª–µ—Ä–µ:**

```asm
mov rdi, 5          ; –ü–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç
mov rsi, 3          ; –í—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç
mov rax, [func]     ; –ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
call rax            ; –ù–µ–ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ (indirect call)
```

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä—è–º—ã–º –≤—ã–∑–æ–≤–æ–º:**

```asm
mov rdi, 5
mov rsi, 3
call Add            ; –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ (direct call)
```

### –ü–µ—Ä–µ–¥–∞—á–∞ —Å–ª–æ–∂–Ω—ã—Ö —Ç–∏–ø–æ–≤

```c
typedef struct {
    int x;
    int y;
} Point;

typedef Point (*CreatePointFunc)(int, int);

CreatePointFunc create = (CreatePointFunc)dlsym(handle, "CreatePoint");
Point p = create(10, 20);
```

### –£–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```c
typedef struct Data* (*AllocFunc)(void);
typedef void (*FreeFunc)(struct Data*);

AllocFunc alloc_data = (AllocFunc)dlsym(handle, "AllocData");
FreeFunc free_data = (FreeFunc)dlsym(handle, "FreeData");

struct Data *d = alloc_data();
// ... —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ ...
free_data(d);
```

---

## 9. –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä

```c
#include <stdio.h>
#include <dlfcn.h>

typedef int (*AddFunc)(int, int);

int main() {
    // 1. –ó–∞–≥—Ä—É–∂–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É
    void *handle = dlopen("./libmath.so", RTLD_LAZY);
    if (!handle) {
        fprintf(stderr, "dlopen error: %s\n", dlerror());
        return 1;
    }

    // 2. –û—á–∏—â–∞–µ–º –±—É—Ñ–µ—Ä –æ—à–∏–±–æ–∫
    dlerror();

    // 3. –ò—â–µ–º —Ñ—É–Ω–∫—Ü–∏—é
    AddFunc add = (AddFunc)dlsym(handle, "Add");

    // 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—à–∏–±–∫—É
    char *error = dlerror();
    if (error != NULL) {
        fprintf(stderr, "dlsym error: %s\n", error);
        dlclose(handle);
        return 1;
    }

    // 5. –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é
    int result = add(10, 20);
    printf("10 + 20 = %d\n", result);

    // 6. –í—ã–≥—Ä—É–∂–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É
    dlclose(handle);

    return 0;
}
```

### –ö–æ–º–ø–∏–ª—è—Ü–∏—è

```bash
# –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É
gcc -shared -fPIC -o libmath.so math.c

# –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É
gcc -o program main.c -ldl

# –ó–∞–ø—É—Å–∫–∞–µ–º
./program
```

---

## 10. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–±—ã—á–Ω—ã–º –≤—ã–∑–æ–≤–æ–º

### –û–±—ã—á–Ω—ã–π –≤—ã–∑–æ–≤ (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ª–∏–Ω–∫–æ–≤–∫–∞)

```c
// math.h
int Add(int a, int b);

// main.c
#include "math.h"

int main() {
    int result = Add(10, 20);  // –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤
    return 0;
}
```

**–ö–æ–º–ø–∏–ª—è—Ü–∏—è:**

```bash
gcc main.c libmath.so -o program
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

- –õ–∏–Ω–∫–µ—Ä –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç —Å–∏–º–≤–æ–ª—ã
- Loader –û–° –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ - –ø—Ä—è–º–æ–π –ø—Ä—ã–∂–æ–∫ —á–µ—Ä–µ–∑ PLT (Procedure Linkage Table)

---

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (runtime loading)

```c
#include <dlfcn.h>

typedef int (*AddFunc)(int, int);

int main() {
    void *handle = dlopen("./libmath.so", RTLD_LAZY);
    AddFunc add = (AddFunc)dlsym(handle, "Add");

    int result = add(10, 20);  // –ù–µ–ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞—Ç–µ–ª—å

    dlclose(handle);
    return 0;
}
```

**–ö–æ–º–ø–∏–ª—è—Ü–∏—è:**

```bash
gcc main.c -ldl -o program
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

- –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Å–∞–º–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤ runtime
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Å–∞–º–∞ –∏—â–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏
- –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ - –Ω–µ–ø—Ä—è–º–æ–π –ø—Ä—ã–∂–æ–∫ —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞—Ç–µ–ª—å

---

### –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞        | –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ª–∏–Ω–∫–æ–≤–∫–∞       | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞            |
| --------------------- | -------------------------- | -------------------------------- |
| **–ö–æ–≥–¥–∞ —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è** | –ù–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏        | –í–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è              |
| **API**               | –û–±—ã—á–Ω—ã–µ –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π     | `dlopen/dlsym/dlclose`           |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤**    | –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç       | –ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –æ—Ç–≤–µ—á–∞–µ—Ç             |
| **–°–∫–æ—Ä–æ—Å—Ç—å**          | –ë—ã—Å—Ç—Ä–µ–µ (–ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤)     | –ß—É—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ (—á–µ—Ä–µ–∑ —É–∫–∞–∑–∞—Ç–µ–ª—å) |
| **–ì–∏–±–∫–æ—Å—Ç—å**          | –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É | –ú–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –Ω–∞ –ª–µ—Ç—É             |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**  | Loader –û–° (–ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ)    | –ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç (–≤ runtime)          |
| **–†–∞–∑–º–µ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã**  | –ë–æ–ª—å—à–µ (—Ç–∞–±–ª–∏—Ü–∞ –∏–º–ø–æ—Ä—Ç–∞)   | –ú–µ–Ω—å—à–µ                           |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**       | –ñ—ë—Å—Ç–∫–æ –∑–∞—à–∏—Ç—ã              | –£–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Å—Ç—Ä–æ–∫–∞–º–∏             |

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏

- [ ] –ü–æ–¥–∫–ª—é—á–∏—Ç—å `<dlfcn.h>`
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø—ã —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ `typedef`
- [ ] –ó–∞–≥—Ä—É–∑–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É —á–µ—Ä–µ–∑ `dlopen()`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç `dlopen()` –Ω–∞ `NULL`
- [ ] –û—á–∏—Å—Ç–∏—Ç—å –±—É—Ñ–µ—Ä –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ `dlerror()`
- [ ] –ù–∞–π—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ `dlsym()`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏ `dlsym()` —á–µ—Ä–µ–∑ `dlerror()`
- [ ] –ü—Ä–∏–≤–µ—Å—Ç–∏ —Ç–∏–ø—ã —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –í—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏
- [ ] –í—ã–≥—Ä—É–∑–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É —á–µ—Ä–µ–∑ `dlclose()`
- [ ] –î–æ–±–∞–≤–∏—Ç—å `-ldl` –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- `man dlopen` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ dlopen
- `man dlsym` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ dlsym
- `man dlclose` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ dlclose
- `man dlerror` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ dlerror

---

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### 1. –ó–∞–±—ã–ª–∏ —Ñ–ª–∞–≥ -ldl

```bash
gcc program.c -o program  # ‚ùå –û—à–∏–±–∫–∞ –ª–∏–Ω–∫–æ–≤–∫–∏
gcc program.c -o program -ldl  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
```

### 2. –ù–µ –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ –æ—à–∏–±–∫—É —á–µ—Ä–µ–∑ dlerror()

```c
void *func = dlsym(handle, "MyFunc");
if (func == NULL) {  // ‚ùå –ú–æ–∂–µ—Ç –¥–∞—Ç—å –ª–æ–∂–Ω–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ
    // ...
}

dlerror();
void *func = dlsym(handle, "MyFunc");
char *error = dlerror();
if (error != NULL) {  // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
    // ...
}
```

### 3. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ

```c
dlopen("libmath.so", RTLD_LAZY);    // ‚ùå –ò—â–µ—Ç –≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—É—Ç—è—Ö
dlopen("./libmath.so", RTLD_LAZY);  // ‚úÖ –ò—â–µ—Ç –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
```

### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ dlclose

```c
MyFunc func = dlsym(handle, "MyFunc");
dlclose(handle);
func(1, 2);  // ‚ùå Undefined behavior!
```

### 5. –ó–∞–±—ã–ª–∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ —Ç–∏–ø

```c
void *func = dlsym(handle, "MyFunc");
int result = func(1, 2);  // ‚ùå –û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

MyFunc func = (MyFunc)dlsym(handle, "MyFunc");
int result = func(1, 2);  // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
```

---

**–ê–≤—Ç–æ—Ä:** GitHub Copilot  
**–î–∞—Ç–∞:** 4 –¥–µ–∫–∞–±—Ä—è 2025
