# Лабораторная работа №4: Динамические библиотеки

## Описание

Проект реализует две динамические библиотеки с различными алгоритмами для:
1. Подсчёта простых чисел на отрезке [A, B]
2. Вычисления наибольшего общего делителя (НОД) двух чисел

### Библиотека 1 (libmath1.so)
- **PrimeCount**: Наивный алгоритм - проверка делимости на все предыдущие числа
- **GCF**: Алгоритм Евклида

### Библиотека 2 (libmath2.so)
- **PrimeCount**: Решето Эратосфена
- **GCF**: Наивный алгоритм - перебор всех делителей

## Структура проекта

```
OS_4_lab/
├── include/
│   └── contracts.h          # Заголовочный файл с контрактами функций
├── lib1/
│   └── lib1.c               # Реализация библиотеки 1
├── lib2/
│   └── lib2.c               # Реализация библиотеки 2
├── program1/
│   └── main.c               # Программа со статической линковкой
├── program2/
│   └── main.c               # Программа с динамической загрузкой
├── CMakeLists.txt           # Конфигурация сборки
└── README.md                # Этот файл
```

## Сборка проекта

### В WSL (Linux)

1. Создайте директорию для сборки:
```bash
mkdir build
cd build
```

2. Сгенерируйте файлы сборки с помощью CMake:
```bash
cmake ..
```

3. Скомпилируйте проект:
```bash
make
```

После сборки в директории `build` появятся:
- `libmath1.so` - первая динамическая библиотека
- `libmath2.so` - вторая динамическая библиотека
- `program1` - исполняемый файл программы 1
- `program2` - исполняемый файл программы 2

## Запуск программ

### Программа 1 (статическая линковка)

```bash
./program1
```

Программа использует библиотеку `libmath1.so`, которая подключается на этапе компиляции.

### Программа 2 (динамическая загрузка)

```bash
./program2
```

Программа загружает библиотеки во время выполнения и позволяет переключаться между ними.

## Использование

### Доступные команды

Обе программы поддерживают следующие команды:

- `1 A B` - Подсчитать количество простых чисел на отрезке [A, B]
- `2 A B` - Вычислить наибольший общий делитель чисел A и B
- `help` - Показать справку
- `exit` - Выход из программы

**Только для программы 2:**
- `0` - Переключить библиотеку (lib1 ↔ lib2)

### Примеры использования

```
> 1 10 20
Количество простых чисел на отрезке [10, 20]: 4

> 2 48 18
Наибольший общий делитель чисел 48 и 18: 6

> 0
Библиотека lib2 (оптимизированные алгоритмы) успешно загружена.

> 1 1 100
Количество простых чисел на отрезке [1, 100]: 25
(Использована библиотека: lib2 (оптимизированные алгоритмы))
```

## Анализ двух типов использования библиотек

### Программа 1: Статическая линковка (на этапе компиляции)

**Преимущества:**
- Быстрее работает (нет накладных расходов на загрузку)
- Проще в использовании (не нужно управлять загрузкой)
- Гарантированная доступность функций

**Недостатки:**
- Нельзя изменить библиотеку без перекомпиляции
- Больший размер исполняемого файла
- Меньше гибкости

### Программа 2: Динамическая загрузка (во время выполнения)

**Преимущества:**
- Можно переключать библиотеки "на лету"
- Меньший размер исполняемого файла
- Возможность выбора реализации в runtime
- Можно обновлять библиотеки независимо

**Недостатки:**
- Накладные расходы на загрузку и поиск функций
- Требуется обработка ошибок загрузки
- Сложнее в реализации

## Технические детали

- **Язык**: C (стандарт C11)
- **Система сборки**: CMake 3.10+
- **Динамическая загрузка**: POSIX API (dlopen, dlsym, dlclose)
- **Платформа**: Linux (WSL)

## Автор

Лабораторная работа выполнена в рамках курса "Операционные системы"
